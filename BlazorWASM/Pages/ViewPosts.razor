@page "/ViewPosts"
@using HttpClients.ClientInterfaces
@using Domain.Models
@using Domain.DTOs
@using Microsoft.AspNetCore.Authorization
@inject IPostService postService;
@inject NavigationManager NavigationManager;

<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <style>
        body, h1, h2, h3, h4, h5 { font-family: "Raleway", sans-serif; }
    </style>
</head>
<body class="w3-light-grey">
<div class="w3-content" style="max-width:1400px">

    <!-- Header -->
    <header class="w3-container w3-center w3-padding-32"> 
        <h1><b>MY BLOG</b></h1>
        <p>Welcome to the blog of <span class="w3-tag">unknown</span></p>
    </header>
    <!-- Grid -->
    <div class="w3-row">
@if (posts == null)
{
    <span>Loading..</span>
}
else if (!posts.Any())
{
    <span>No posts to be found</span>
}
else
{
    @foreach (Post post in posts)
    {
        <!-- Blog entries -->
        <div class="w3-col l8 s12">
                    <!-- Blog entry -->
                    <div class="w3-card-4 w3-margin w3-white">
                        <div class="w3-container">
                            <h3><b>@post.Title</b></h3>
                            <!-- Image Box -->
                            <div class="image-box">
                                <img src="@post.imageUrl" alt="Nature" style="width:100%">
                            </div>
                        </div>
        
                        <div class="w3-container">
                            <p>@post.description</p>
                            <div class="w3-row">
                                <div class="w3-col m8 s12">
                                    <p><button class="w3-button w3-padding-large w3-white w3-border"><b>READ MORE Â»</b></button></p>
                                </div>
                                <div class="w3-col m4 w3-hide-small">
                                    <!-- Display the number of likes -->
                                    <p><span class="w3-padding-large w3-right"><b>Likes  </b> <span class="w3-badge">0</span></span></p>
                                    </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <!-- END BLOG ENTRIES -->
                </div>
    }
}
<!-- Introduction menu -->
        <div class="w3-col l4">
            <!-- About Card -->
            <div class="w3-card w3-margin w3-margin-top">
                <img src="/w3images/avatar_g.jpg" style="width:100%">
                <div class="w3-container w3-white">
                    <h4><b>My Name</b></h4>
                    <p>Just me, myself and I, exploring the universe of uknownment. I have a heart of love and a interest of lorem ipsum and mauris neque quam blog. I want to share my world with you.</p>
                </div>
            </div>
            <hr>
        </div>
    </div>
</div>
</body>

</html>


@code {
    private IEnumerable<Post>? posts;
    private string msg = "";
    private string? location;
    private int? category;
    private string? title;

    protected override async Task OnInitializedAsync()
    {
        msg = "";
        try
        {
            SearchParameters searchParameters = new SearchParameters();
            posts = await postService.FindByParameters(searchParameters);
        }
        catch (Exception e)
        {
            Console.WriteLine(e);
            msg = e.Message;
        }
    }
    /* private async Task goToPosts(int id)
    {
        postService.id = id;
        NavigationManager.NavigateTo("/ViewOnePost");
     }*/

    private async Task Search()
    {
        try
        {
            SearchParameters searchParameters = new SearchParameters(title,location,"home",0);
            posts = await postService.FindByParameters(searchParameters);
        }
        catch (Exception e)
        {
            Console.WriteLine(e);
            msg = e.Message;
        }
    }
}
